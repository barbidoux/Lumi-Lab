{
  "name": "lora_small",
  "description": "LoRA configuration for small model fine-tuning",
  "version": "1.0",

  "training_params": {
    "learning_rate": 5e-4,
    "num_train_epochs": 3,
    "max_steps": -1,
    "per_device_train_batch_size": 8,
    "per_device_eval_batch_size": 8,
    "gradient_accumulation_steps": 4,
    "warmup_steps": 300,
    "weight_decay": 0.01,
    "logging_steps": 25,
    "save_steps": 500,
    "eval_steps": 250,
    "evaluation_strategy": "steps",
    "save_strategy": "steps",
    "load_best_model_at_end": true,
    "metric_for_best_model": "eval_loss",
    "greater_is_better": false,
    "save_total_limit": 5,
    "seed": 42,
    "data_seed": 42,
    "dataloader_num_workers": 4,
    "remove_unused_columns": false,
    "optim": "adamw_torch",
    "lr_scheduler_type": "cosine",
    "fp16": true,
    "gradient_checkpointing": true,
    "ddp_find_unused_parameters": false,
    "group_by_length": false,
    "report_to": ["tensorboard"]
  },

  "lora_config": {
    "r": 32,
    "lora_alpha": 16,
    "target_modules": [
      "q_proj",
      "k_proj",
      "v_proj",
      "o_proj",
      "gate_proj",
      "up_proj",
      "down_proj"
    ],
    "lora_dropout": 0.1,
    "bias": "none",
    "task_type": "CAUSAL_LM",
    "fan_in_fan_out": false,
    "init_lora_weights": true
  },

  "dataset_config": {
    "max_seq_length": 1024,
    "packing": true,
    "dataset_text_field": "text",
    "formatting_func": null,
    "chars_per_token": 4.0
  },

  "evaluation_config": {
    "eval_dataset_size": 500,
    "eval_accumulation_steps": 1,
    "generation_config": {
      "max_new_tokens": 160,
      "temperature": 0.7,
      "top_p": 0.9,
      "do_sample": true,
      "pad_token_id": 0
    },
    "eval_prompts": [
      "What is artificial intelligence and how is it used today?",
      "Explain machine learning in simple terms with examples.",
      "How do computers learn from data?",
      "What are the benefits and risks of AI technology?",
      "Describe how AI assistants like chatbots work.",
      "Write a short explanation of how neural networks function.",
      "What is the difference between AI and traditional programming?"
    ]
  },

  "checkpointing": {
    "save_safetensors": true,
    "save_on_each_node": false,
    "resume_from_checkpoint": null,
    "ignore_data_skip": false
  },

  "hardware_optimization": {
    "auto_find_batch_size": false,
    "dataloader_pin_memory": true,
    "max_memory_mb": 10000,
    "low_cpu_mem_usage": true
  }
}